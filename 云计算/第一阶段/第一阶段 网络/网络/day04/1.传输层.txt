一、传输层

1、传输层概述
1.传输层的作用
1)网络层提供点到点的连接  #ip到ip，找到主机

2)传输层提供端到端的连接 #服务到服务，找到进程

2.传输层的协议
TCP(Transmission Control Protocol)
– 传输控制协议
– 可靠的、面向连接的协议
– 传输效率低
• UDP(User Datagram Protocol) 
– 用户数据报协议
– 不可靠的、无连接的服务   #相对来说
– 传输效率


2、TCP协议     #可靠的原因

1.TCP的封装格式
 
0  ——    15 16    ——              31
    源端口号   目标端口号
         32位序列号 
         32位确认号
4位  保留 U A P R S F
首部  (6  R C S S Y I    16位窗口大小
长度  位) G K H T N N  
16位校验和 16位紧急指针
       可选项
        数据

2.TCP的连接-三次握手     #SYN 发送连接请求 、ACK确认请求 
A  B
1、A发送 SYN          #A请求建立连接
(seq=100, ctl=SYN)
2、B发送 SYN 、ACK    #B发送确认 并 请求连接
(seq=300, ack=101,
ctl=SYN、ACK
3、A发送ACK           #A发送确认
(seq=101 ack=301
ctl=ACK)

3.TCP的连接与断开       #FIN 发送断开请求
TCP的四次断开
A  B 
1.A发送 FIN,请求断开连接  #A发送请求断开
(FIN=1,ACK=1)

2.B发送 ACK            #B确认断开
(ACK=1)

3.B发送 FIN,请求断开连接  #B发送请求断开
( FIN=1,ACK=1)

4.发送ACK               #A确认断开
( ACK=1)
( ACK=1)  

3.TCP的应用

21 	FTP 	      FTP服务器所开放的控制端口
23 	TELNET 	用于远程登录，可以远程控制管理目标计算机
25 	SMTP 	      SMTP服务器开放的端口，用于发送邮件
80 	HTTP 	      超文本传输协议
53 	DNS 	      域名服务，当用户输入网站的名称后，由DNS负责将它解析成IP地址，这个过程中用到的端口号是53  #递归查询
110   pop3

3、UDP协议

1.UDP的封装格式
16位源端口号   16位目标端口号
16位UDP长度   16位UDP校验和
         数据

2.UDP的应用
69  TFTP 简单文件传输协议
53  DNS  域名服务    #迭代查询
123 NTP 网络时间协议

3.UDP的流控和差错控制
• UDP缺乏可靠机制
• UDP只有校验和来提供差错控制  #上层重新发送

– 需要上层协议来提供差错控制:例如TFTP协议
TFTP协议提供分块传输、分块确认机制,保证数据传输的可靠性



